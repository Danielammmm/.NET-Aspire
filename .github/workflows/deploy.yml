name: Simular Deploy

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  simulate-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: 📦 Clonar repositorio
      uses: actions/checkout@v3

    - name: 🧱 Instalar .NET 9
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '9.0.100-preview.2'

    - name: 🔧 Restaurar dependencias
      run: dotnet restore

    - name: 🏗️ Compilar solución
      run: dotnet build --no-restore

    - name: 🚀 Intentar publicar OrdersService
      run: |
        echo "Intentando simular un despliegue..."
        if dotnet publish OrdersService/OrdersService.csproj -c Release -o ./publish; then
          echo "✔️ Se podría hacer deploy: publicación exitosa ✅"
        else
          echo "❌ No se puede hacer deploy: falló la publicación ❌"
          exit 1
        fi
